# ğŸ³ Docker Compose æ–‡ä»¶è¯´æ˜

## ğŸ“‹ æ–‡ä»¶æ¦‚è§ˆ

| æ–‡ä»¶å | ç”¨é€” | ä½¿ç”¨åœºæ™¯ |
|--------|------|----------|
| `docker-compose.yml` | **åŸºç¡€é…ç½®** | ç”Ÿäº§ç¯å¢ƒåŸºç¡€é…ç½® |
| `docker-compose.dev.yml` | **å¼€å‘ç¯å¢ƒ** | æœ¬åœ°å¼€å‘ä½¿ç”¨ |
| `docker-compose.prod.yml` | **ç”Ÿäº§ç¯å¢ƒ** | ç”Ÿäº§éƒ¨ç½²ä½¿ç”¨ |
| `docker-compose.override.yml.example` | **è¦†ç›–é…ç½®æ¨¡æ¿** | æœ¬åœ°ä¸ªæ€§åŒ–é…ç½® |

## ğŸ”§ å„æ–‡ä»¶è¯¦ç»†è¯´æ˜

### 1. `docker-compose.yml` - åŸºç¡€é…ç½®
**ç”¨é€”**: ç”Ÿäº§ç¯å¢ƒçš„åŸºç¡€é…ç½®æ¨¡æ¿
**ç‰¹ç‚¹**:
- ä½¿ç”¨é¢„æ„å»ºçš„é•œåƒ (`build: ./backend`)
- åŸºç¡€çš„å®‰å…¨é…ç½®
- é€‚åˆç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

**åŒ…å«æœåŠ¡**:
- `mysql` - MySQL 8.0 æ•°æ®åº“
- `redis` - Redis 7 ç¼“å­˜
- `backend` - Go åç«¯æœåŠ¡
- `frontend` - Vue3 å‰ç«¯æœåŠ¡

### 2. `docker-compose.dev.yml` - å¼€å‘ç¯å¢ƒ
**ç”¨é€”**: æœ¬åœ°å¼€å‘ç¯å¢ƒé…ç½®
**ç‰¹ç‚¹**:
- ä½¿ç”¨å¼€å‘é•œåƒ (`golang:1.21-alpine`, `node:20-alpine`)
- æ”¯æŒçƒ­é‡è½½å’Œå®æ—¶è°ƒè¯•
- åŒ…å« Nginx åå‘ä»£ç†
- è¯¦ç»†çš„æ—¥å¿—è¾“å‡º

**åŒ…å«æœåŠ¡**:
- `mysql` - å¼€å‘æ•°æ®åº“
- `redis` - å¼€å‘ç¼“å­˜
- `backend-dev` - Go å¼€å‘æœåŠ¡
- `frontend-dev` - Vue3 å¼€å‘æœåŠ¡
- `nginx` - å¼€å‘ç¯å¢ƒåå‘ä»£ç†

**å¼€å‘ç‰¹æ€§**:
- ä»£ç çƒ­é‡è½½
- è°ƒè¯•æ¨¡å¼
- è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯
- å¼€å‘å·¥å…·é›†æˆ

### 3. `docker-compose.prod.yml` - ç”Ÿäº§ç¯å¢ƒ
**ç”¨é€”**: ç”Ÿäº§ç¯å¢ƒå®Œæ•´é…ç½®
**ç‰¹ç‚¹**:
- ä¸¥æ ¼çš„å®‰å…¨é…ç½®
- èµ„æºé™åˆ¶
- åªè¯»æ–‡ä»¶ç³»ç»Ÿ
- é root ç”¨æˆ·è¿è¡Œ
- SSL/TLS æ”¯æŒ

**å®‰å…¨ç‰¹æ€§**:
- ç”¨æˆ·æƒé™é™åˆ¶
- åªè¯»æ–‡ä»¶ç³»ç»Ÿ
- èµ„æºä½¿ç”¨é™åˆ¶
- å®‰å…¨é€‰é¡¹é…ç½®

### 4. `docker-compose.override.yml.example` - è¦†ç›–é…ç½®æ¨¡æ¿
**ç”¨é€”**: æœ¬åœ°ä¸ªæ€§åŒ–é…ç½®æ¨¡æ¿
**ç‰¹ç‚¹**:
- è¦†ç›–é»˜è®¤é…ç½®
- è®¾ç½®æ•æ„Ÿä¿¡æ¯
- ä¸è¢« Git è·Ÿè¸ª

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### å¼€å‘ç¯å¢ƒ
```bash
# å¯åŠ¨å¼€å‘ç¯å¢ƒ
docker-compose -f docker-compose.dev.yml up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose -f docker-compose.dev.yml logs -f

# åœæ­¢æœåŠ¡
docker-compose -f docker-compose.dev.yml down
```

### ç”Ÿäº§ç¯å¢ƒ
```bash
# å¯åŠ¨ç”Ÿäº§ç¯å¢ƒ
docker-compose -f docker-compose.prod.yml up -d

# æŸ¥çœ‹çŠ¶æ€
docker-compose -f docker-compose.prod.yml ps

# åœæ­¢æœåŠ¡
docker-compose -f docker-compose.prod.yml down
```

### æœ¬åœ°ä¸ªæ€§åŒ–é…ç½®
```bash
# 1. å¤åˆ¶è¦†ç›–é…ç½®æ¨¡æ¿
cp docker-compose.override.yml.example docker-compose.override.yml

# 2. ç¼–è¾‘é…ç½®æ–‡ä»¶
# ä¿®æ”¹å¯†ç ã€å¯†é’¥ç­‰æ•æ„Ÿä¿¡æ¯

# 3. å¯åŠ¨æœåŠ¡ï¼ˆä¼šè‡ªåŠ¨åº”ç”¨è¦†ç›–é…ç½®ï¼‰
docker-compose up -d
```

## ğŸ” é…ç½®å¯¹æ¯”

| ç‰¹æ€§ | å¼€å‘ç¯å¢ƒ | ç”Ÿäº§ç¯å¢ƒ |
|------|----------|----------|
| **é•œåƒç±»å‹** | å¼€å‘é•œåƒ | ç”Ÿäº§é•œåƒ |
| **çƒ­é‡è½½** | âœ… æ”¯æŒ | âŒ ä¸æ”¯æŒ |
| **è°ƒè¯•æ¨¡å¼** | âœ… å¼€å¯ | âŒ å…³é—­ |
| **å®‰å…¨é…ç½®** | åŸºç¡€ | ä¸¥æ ¼ |
| **èµ„æºé™åˆ¶** | æ—  | æœ‰ |
| **ç”¨æˆ·æƒé™** | root | éroot |
| **æ–‡ä»¶ç³»ç»Ÿ** | å¯å†™ | åªè¯» |
| **æ—¥å¿—çº§åˆ«** | è¯¦ç»† | ç²¾ç®€ |

## ğŸ› ï¸ æœåŠ¡è¯´æ˜

### MySQL æ•°æ®åº“
- **å¼€å‘**: `sajuna-blog-mysql-dev`
- **ç”Ÿäº§**: `sajuna-blog-mysql-prod`
- **ç«¯å£**: 3306
- **æ•°æ®æŒä¹…åŒ–**: ä½¿ç”¨ Docker Volume

### Redis ç¼“å­˜
- **å¼€å‘**: `sajuna-blog-redis-dev`
- **ç”Ÿäº§**: `sajuna-blog-redis-prod`
- **ç«¯å£**: 6379
- **å¯†ç **: ç”Ÿäº§ç¯å¢ƒéœ€è¦å¯†ç 

### åç«¯æœåŠ¡
- **å¼€å‘**: `sajuna-blog-backend-dev`
- **ç”Ÿäº§**: `sajuna-blog-backend-prod`
- **ç«¯å£**: 8080
- **è¯­è¨€**: Go + Gin

### å‰ç«¯æœåŠ¡
- **å¼€å‘**: `sajuna-blog-frontend-dev`
- **ç”Ÿäº§**: `sajuna-blog-frontend-prod`
- **ç«¯å£**: 3000
- **æ¡†æ¶**: Vue3 + TypeScript

### Nginx ä»£ç†
- **å¼€å‘**: `sajuna-blog-nginx-dev`
- **ç”Ÿäº§**: `sajuna-blog-nginx-prod`
- **ç«¯å£**: 80 (HTTP), 443 (HTTPS)
- **åŠŸèƒ½**: åå‘ä»£ç†ã€è´Ÿè½½å‡è¡¡

## ğŸ”§ ç¯å¢ƒå˜é‡

### æ•°æ®åº“é…ç½®
```bash
MYSQL_ROOT_PASSWORD=your-root-password
MYSQL_USER=your-database-user
MYSQL_PASSWORD=your-database-password
```

### Redis é…ç½®
```bash
REDIS_PASSWORD=your-redis-password
```

### åº”ç”¨é…ç½®
```bash
JWT_SECRET=your-jwt-secret-key
GIN_MODE=release  # æˆ– debug
```

## ğŸ“ æœ€ä½³å®è·µ

1. **å¼€å‘æ—¶ä½¿ç”¨** `docker-compose.dev.yml`
2. **ç”Ÿäº§éƒ¨ç½²ä½¿ç”¨** `docker-compose.prod.yml`
3. **æ•æ„Ÿä¿¡æ¯ä½¿ç”¨** `docker-compose.override.yml`
4. **å®šæœŸå¤‡ä»½** æ•°æ®åº“æ•°æ®
5. **ç›‘æ§èµ„æºä½¿ç”¨** æƒ…å†µ
6. **å®šæœŸæ›´æ–°** åŸºç¡€é•œåƒ

## ğŸš¨ æ³¨æ„äº‹é¡¹

- ç”Ÿäº§ç¯å¢ƒå¿…é¡»è®¾ç½®å¼ºå¯†ç 
- å®šæœŸæ›´æ–° Docker é•œåƒ
- ç›‘æ§å®¹å™¨èµ„æºä½¿ç”¨
- å¤‡ä»½é‡è¦æ•°æ®
- ä½¿ç”¨ HTTPS è¯ä¹¦
